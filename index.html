<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Save and Protect</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
        }
        .container {
            margin-bottom: 20px;
        }
        button {
            margin-top: 10px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>Word Save and Protect</h1>

    <!-- Save Words to .txt -->
    <div class="container">
        <h2>Save Words to .txt File</h2>
        <textarea id="wordBox" rows="5" cols="50" placeholder="Type your words here..."></textarea><br>
        <button onclick="saveToTxt()">Save to .txt</button>
    </div>

    <!-- Password Protect .txt -->
    <div class="container">
        <h2>Encrypt .txt File with Password</h2>
        <input type="file" id="fileInput" accept=".txt"><br>
        <input type="password" id="passwordInput" placeholder="Enter Password"><br>
        <button onclick="encryptFile()">Protect File</button>
        <a id="downloadLink" style="display:none;">Download Encrypted File</a>
    </div>

    <script>
        // Save words to .txt file
        function saveToTxt() {
            const content = document.getElementById("wordBox").value;
            const blob = new Blob([content], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "words.txt";
            link.click();
        }

        // Encrypt file with password
        async function encryptFile() {
            const fileInput = document.getElementById("fileInput").files[0];
            const password = document.getElementById("passwordInput").value;

            if (!fileInput || !password) {
                alert("Please select a file and enter a password.");
                return;
            }

            // Read file content
            const fileContent = await fileInput.text();

            // Encrypt file content
            const encoder = new TextEncoder();
            const data = encoder.encode(fileContent);
            const passwordHash = await crypto.subtle.digest("SHA-256", encoder.encode(password));
            const key = await crypto.subtle.importKey(
                "raw",
                passwordHash,
                { name: "AES-GCM" },
                false,
                ["encrypt"]
            );

            const iv = crypto.getRandomValues(new Uint8Array(12));
            const encryptedData = await crypto.subtle.encrypt(
                { name: "AES-GCM", iv },
                key,
                data
            );

            // Combine IV and encrypted data
            const combined = new Uint8Array(iv.length + encryptedData.byteLength);
            combined.set(iv);
            combined.set(new Uint8Array(encryptedData), iv.length);

            // Create downloadable encrypted file
            const blob = new Blob([combined], { type: "application/octet-stream" });
            const downloadLink = document.getElementById("downloadLink");
            downloadLink.href = URL.createObjectURL(blob);
            downloadLink.download = "protected.txt";
            downloadLink.style.display = "inline-block";
            downloadLink.textContent = "Download Protected File";
        }
    </script>
</body>
</html>
